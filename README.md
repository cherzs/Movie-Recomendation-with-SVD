# üé¨ **Movie Recommendation System**

## üöÄ **Project Overview**
This project aims to develop an accurate and personalized movie recommendation system using two datasets: one containing basic movie information, including the cast and crew, and the other containing detailed metadata such as budget, genre, popularity, and ratings. The goal is to leverage these datasets to recommend movies to users based on their preferences.

---

## üìä **Datasets Used**
This project utilizes two datasets from Kaggle, providing comprehensive data about various movies:

1. **Movies Dataset 1**:  
   [The Movies Dataset](https://www.kaggle.com/datasets/rounakbanik/the-movies-dataset)  
   Key Features:
   - `movie_id`: Unique identifier for each movie.
   - `cast`: The names of lead and supporting actors.
   - `crew`: The names of key crew members (Director, Editor, Composer, Writer, etc.).

2. **Movies Dataset 2**:  
   [TMDB Movie Metadata](https://www.kaggle.com/datasets/tmdb/tmdb-movie-metadata)  
   Key Features:
   - `budget`: The budget in which the movie was made.
   - `genre`: The genre(s) of the movie (e.g., Action, Comedy, Thriller).
   - `homepage`: A link to the homepage of the movie.
   - `id`: The movie_id corresponding to the first dataset.
   - `keywords`: Keywords or tags related to the movie.
   - `original_language`: Language in which the movie was made.
   - `original_title`: The original title of the movie.
   - `overview`: A brief description of the movie.
   - `popularity`: Numeric value representing the movie's popularity.
   - `production_companies`: The production house of the movie.
   - `production_countries`: The country of production.
   - `release_date`: The date of movie release.
   - `revenue`: Worldwide revenue generated by the movie.
   - `runtime`: Movie runtime in minutes.
   - `status`: Movie status (Released or Rumored).
   - `tagline`: The tagline of the movie.
   - `title`: Title of the movie.
   - `vote_average`: The average rating received by the movie.
   - `vote_count`: The total count of votes received.
   - 
- The columns in `tmdb_5000_credits` were renamed for clarity, and data from `tmdb_5000_credits` was merged with `tmdb_5000_movies` based on the `id`.
- The `overview` column, which contains plot summaries, was preprocessed by filling missing values with an empty string.
  
  ### Here is visualization of popular movies
![image](https://github.com/user-attachments/assets/308fa771-3b9a-4378-b4dc-6e92a77e8444)

---

## üõ†Ô∏è **Tools and Technologies**

This project leverages a variety of tools and libraries to process data, build models, and visualize results:

### **Programming Language**:
- **Python**: The core programming language used for developing the recommendation system.

### **Libraries**:
- **pandas**: For data manipulation and preprocessing.
- **numpy**: For numerical operations.
- **matplotlib** & **seaborn**: For data visualization and plotting.
- **surprise**: A Python library for building and evaluating collaborative filtering-based recommendation systems.
- **gensim**: For Word2Vec, a technique used to capture word semantics for content-based filtering.
- **scikit-learn**: For machine learning algorithms and model evaluation.
- **Flask**: To serve the recommendation system as a web service.
- **wordcloud**: For visualizing keywords and other text data as word clouds.
- **TfidfVectorizer**: From **scikit-learn**, used to convert a collection of text documents to a matrix of TF-IDF features for content-based filtering.

### **Algorithms and Techniques**:
- **Singular Value Decomposition (SVD)**: Used for collaborative filtering-based recommendations.
- **Content-Based Filtering**: A method that recommends movies based on their metadata such as genre, keywords, and cast.
- **Collaborative Filtering**: A method that recommends movies based on user-item interactions, utilizing techniques like matrix factorization.
  
### **Content-Based Filtering (TF-IDF & Cosine Similarity)**
 implemented a content-based filtering approach using the `overview` column of movies:
1. **TF-IDF Vectorizer**: A `TfidfVectorizer` was applied to the `overview` column to transform text into numerical vectors.
2. **Cosine Similarity**: Cosine similarity was used to measure the similarity between movies based on their overview text. This allows for recommending movies that are similar to a given movie based on plot summaries.

#### **Example Recommendations**:
- **For "The Dark Knight Rises"**: 
  - Movies like "Batman Begins", "The Dark Knight", "Inception", and "Interstellar" are recommended based on cosine similarity of their overviews.

---

### **Popularity-Based Filtering**
 analyzed movie popularity by sorting movies based on the `popularity` column.  visualized the top 6 most popular movies using a bar chart:
- **Top 6 Movies**: Movies such as "The Avengers", "Avengers: Infinity War", and "Guardians of the Galaxy" were the most popular in the dataset.

---

### **Collaborative Filtering (SVD)**
 implemented a collaborative filtering approach using the `SVD` (Singular Value Decomposition) algorithm from the `surprise` library:
1. **Grid Search**: A `GridSearchCV` was used to tune hyperparameters (e.g., number of factors, learning rate, regularization) for the SVD model.
2. **Best RMSE**: The best root mean square error (RMSE) score from the grid search was evaluated, and the parameters giving the lowest RMSE were chosen.
3. **Prediction**: After fitting the model to the training set, the model was used to predict movie ratings.

Here's a structured summary for your results:

---

## Model Results

### Best RMSE Score
- **RMSE Score**: 0.891477307669755

### Hyperparameters Used:
- **n_factors**: 150  
- **n_epochs**: 30  
- **lr_all**: 0.005  
- **reg_all**: 0.1

### Prediction
- **User ID**: 1  
- **Item ID**: 302  
- **Actual Rating (r_ui)**: 3  
- **Estimated Rating (est)**: 2.6947  
- **Was the prediction impossible?**: No

---

### **Word2Vec for Content Similarity**
 trained a Word2Vec model on movie overviews to create word embeddings for each movie's plot summary:
1. **Word Embeddings**: The Word2Vec model created vector representations for each overview. Cosine similarity was then computed between these vectors.
2. **Example Recommendations**: By using Word2Vec,  recommended similar movies to a given title based on the vector similarity of their overviews.

#### **Example**:
- **For "The Dark Knight Rises"**: 
Here‚Äôs how you can format the list of movies into a table in the README:

| **Index** | **Movie Title**                                      |
|-----------|------------------------------------------------------|
| 65        | The Dark Knight                                      |
| 299       | Batman Forever                                       |
| 428       | Batman Returns                                       |
| 1359      | Batman                                               |
| 3854      | Batman: The Dark Knight Returns, Part 2              |
| 119       | Batman Begins                                        |
| 2507      | Slow Burn                                            |
| 9         | Batman v Superman: Dawn of Justice                   |
| 1181      | JFK                                                  |
| 210       | Batman & Robin                                       |

---
- **For "The Avengerss"**:

| **Index** | **Movie Title**                             |
|-----------|---------------------------------------------|
| 7         | Avengers: Age of Ultron                    |
| 3144      | Plastic                                    |
| 1715      | Timecop                                    |
| 4124      | This Thing of Ours                         |
| 3311      | Thank You for Smoking                       |
| 3033      | The Corruptor                               |
| 588       | Wall Street: Money Never Sleeps             |
| 2136      | Team America: World Police                  |
| 1468      | The Fountain                                |
| 1286      | Snowpiercer                                 |

---

### **Trend Analysis (Rating Over Time)**
 analyzed how movie ratings changed over time:
-  grouped movies by their release year and calculated the average rating for each year.
- **Visualization**: A line plot was generated showing the trend of average ratings over time, indicating whether movie ratings are increasing or decreasing over the years.
![image](https://github.com/user-attachments/assets/9dd35fd4-249e-4043-bcda-ebead608fcf4)

Distribution of Movies Ratings
![image](https://github.com/user-attachments/assets/cfc9192e-80b5-4df5-bf00-ec51e6c2f141)

Word Cloud of Recomended movies
![image](https://github.com/user-attachments/assets/0d32f0ce-6799-40db-abcd-d0f4b2a18a1e)

---

### **Additional Visualizations**
- **Distribution of Ratings**: A histogram was plotted to show the distribution of movie ratings. The majority of movies had ratings in the 5-7 range.
- **Word Cloud**: A word cloud was generated from the overviews of recommended movies, providing a visual representation of frequently occurring words in the descriptions of recommended movies.

---

### **Flask API**
 implemented a basic Flask web application:
- A route `/recommend` accepts a movie title as input and returns a list of recommended movies based on Word2Vec similarity.

---

### **Evaluation**
- **Collaborative Filtering RMSE**: The RMSE (Root Mean Squared Error) for the SVD model was calculated on the test set to evaluate its performance.
- **Best RMSE**: The model's best RMSE score from the GridSearchCV was printed, and the model showed reasonable prediction accuracy.
  
### Best RMSE from GridSearchCV:

| **Metric**        | **Value**            |
|-------------------|----------------------|
| Best RMSE Score   | 0.8915               |

### RMSE on Testset:

| **Metric**        | **Value**            |
|-------------------|----------------------|
| RMSE on Testset   | 0.8868               |

---

### **Conclusion and Insights**
- r recommendation system combines both **content-based** and **collaborative filtering** approaches, making it flexible and capable of recommending movies based on both movie features (overview, genre, etc.) and user preferences.
- Visualizations of movie popularity, ratings, and trends over time provide valuable insights into movie patterns and audience behavior.
- The use of advanced models like Word2Vec for content-based filtering enhances the accuracy of recommendations based on movie plot similarities.

This system can be further enhanced by integrating more data, such as genres, actors, or user demographics, and experimenting with other recommendation algorithms.
